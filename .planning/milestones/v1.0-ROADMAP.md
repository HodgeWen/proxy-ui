# Milestone v1.0: MVP

**Status:** ✅ SHIPPED 2026-02-19
**Phases:** 1-10
**Total Plans:** 34

## Overview

从零构建一个 sing-box 管理面板：先建立基础（认证、数据库、sing-box 集成、UI 框架），再实现入站管理、证书管理、用户管理、订阅系统、流量统计、核心版本管理，最后完成三种部署方式与 HTTPS 支持。每个阶段交付可验证的用户能力。

## Phases

### Phase 1: Foundation

**Goal**: 管理员可以登录面板，面板能与 sing-box 交互，UI 具备暗色主题与弹框表单框架

**Depends on**: Nothing (first phase)

**Requirements**: SYS-01, COR-01, COR-02, UX-01, UX-02, UX-03, UX-04, UX-05

**Plans:** 3 plans

- [x] 01-01-PLAN.md — 项目脚手架 + 认证（Setup/Login、Session、Admin）
- [x] 01-02-PLAN.md — sing-box 集成（版本检测、配置应用、重启）
- [x] 01-03-PLAN.md — UI 框架 + 仪表盘（暗色主题、Sidebar、sing-box 状态）

**Completed:** 2026-02-11

---

### Phase 2: Inbound Management

**Goal**: 用户可完整管理 VLESS 和 Hysteria2 入站（添加、编辑、删除、TLS、传输选项）

**Depends on**: Phase 1

**Requirements**: INB-01, INB-02, INB-03, INB-04, INB-05, INB-06, INB-07, INB-08, INB-09, INB-10

**Plans:** 6 plans

- [x] 02-01-PLAN.md — Inbound model + DB layer (GORM, CRUD)
- [x] 02-02-PLAN.md — ConfigGenerator (DB → sing-box JSON)
- [x] 02-03-PLAN.md — Inbound API (CRUD, apply config, restart)
- [x] 02-04-PLAN.md — Inbound list UI (table, Edit, Delete)
- [x] 02-05-PLAN.md — Inbound form modal (VLESS/Hysteria2, TLS, transport)
- [x] 02-06-PLAN.md — Gap closure: protocol sync, FieldLabel tooltips

**Completed:** 2026-02-11

---

### Phase 3: Certificate Management

**Goal**: 管理员可指定 TLS 证书路径并将其关联到入站

**Depends on**: Phase 2

**Requirements**: CRT-01, CRT-02

**Plans:** 3 plans

- [x] 03-01-PLAN.md — Certificate model + DB + ConfigGenerator resolve cert_id
- [x] 03-02-PLAN.md — Cert CRUD API + certificates list/form UI
- [x] 03-03-PLAN.md — InboundFormModal TLS cert selector

**Completed:** 2026-02-12

---

### Phase 4: User Management

**Goal**: 管理员可创建、编辑、删除用户，分配节点，设置流量与到期，支持搜索与批量操作

**Depends on**: Phase 2

**Requirements**: USR-01, USR-02, USR-03, USR-04, USR-05, USR-06, USR-07, USR-08, USR-09

**Plans:** 4 plans

- [x] 04-01-PLAN.md — User model + ConfigGenerator (derive users from DB)
- [x] 04-02-PLAN.md — User CRUD API + batch endpoint
- [x] 04-03-PLAN.md — Users page + table + UserFormModal
- [x] 04-04-PLAN.md — Search + batch UI + verify

**Completed:** 2026-02-12

---

### Phase 5: Subscription System

**Goal**: 每个用户有唯一订阅链接，支持 Base64/Clash 格式、QR 码、信息页

**Depends on**: Phase 4

**Requirements**: SUB-01, SUB-02, SUB-03, SUB-04, SUB-05

**Plans:** 3 plans

- [x] 05-01-PLAN.md — Subscription token + generator + GET /sub/{token}
- [x] 05-02-PLAN.md — Admin API: reset token, subscription_url/nodes in GetUser
- [x] 05-03-PLAN.md — UserSubscriptionCard (QR, copy, reset) in UserSubscriptionModal

**Completed:** 2026-02-12

---

### Phase 6: Traffic Statistics

**Goal**: 面板展示每个用户和每个入站的流量使用量

**Depends on**: Phase 4

**Requirements**: TRF-01, TRF-02

**Plans:** 3 plans

- [x] 06-01-PLAN.md — Stats backend (proto, StatsClient, DB columns, ConfigGenerator v2ray_api, cron)
- [x] 06-02-PLAN.md — API traffic responses + sort + reset_traffic
- [x] 06-03-PLAN.md — Frontend InboundTable + UserTable traffic columns

**Completed:** 2026-02-12

---

### Phase 7: sing-box Core Management

**Goal**: 管理员可在面板中更新或回滚 sing-box 核心版本

**Depends on**: Phase 1

**Requirements**: COR-03, COR-04

**Plans:** 2 plans

- [x] 07-01-PLAN.md — Backend: CoreUpdater + API (versions, update, rollback)
- [x] 07-02-PLAN.md — Frontend: Dashboard version card + update/rollback + badge

**Completed:** 2026-02-12

---

### Phase 8: Deployment & Production

**Goal**: 用户可通过 Docker、bash 脚本或单二进制三种方式部署面板，并支持 HTTPS

**Depends on**: Phase 1

**Requirements**: SYS-02, SYS-03, SYS-04, SYS-05

**Plans:** 4 plans

- [x] 08-01-PLAN.md — Pure-Go SQLite migration + Panel config + HTTPS proxy
- [x] 08-02-PLAN.md — Docker (Dockerfile + compose, single container s-ui+sing-box)
- [x] 08-03-PLAN.md — Install script (curl|bash, systemd, install/update/uninstall)
- [x] 08-04-PLAN.md — GitHub Actions release (tag v* → build amd64/arm64, publish)

**Completed:** 2026-02-12

---

### Phase 9: Certificate Config Sync (Gap Closure)

**Goal**: 修复证书更新后配置未联动问题，确保更新证书路径后立即重生成配置并应用到 sing-box

**Depends on**: Phase 3, Phase 1

**Requirements**: CRT-02, COR-01

**Gap Closure**: Closes gaps from audit (`v1.0-MILESTONE-AUDIT.md` integration gap: Cert update -> Generate -> Apply)

**Plans:** 3 plans

- [x] 09-01-PLAN.md — Backend wiring: UpdateCertificateHandler 触发 Generate/Apply/Restart
- [x] 09-02-PLAN.md — 回滚策略与错误处理一致化
- [x] 09-03-PLAN.md — 补充验证覆盖（证书路径更新后立即生效）

**Completed:** 2026-02-12

---

### Phase 10: Sidebar Pages & Config Fix

**Goal**: 侧边栏三个禁用页面全部启用（订阅/流量/核心），仪表盘改为统计概览，配置路径 bug 全面修复

**Depends on**: Phase 9

**Requirements**: UX-01, UX-02, UX-05

**Plans:** 3 plans

- [x] 10-01-PLAN.md — 后端配置路径修复 + stats/config-file 端点
- [x] 10-02-PLAN.md — 订阅页 + 流量页（前端，独立于后端）
- [x] 10-03-PLAN.md — 核心页 + 仪表盘重构 + 侧边栏/路由

**Completed:** 2026-02-19

---

## Milestone Summary

**Key Decisions:**

- Go 后端 + React 前端（shadcn/ui + Tailwind）单仓库架构
- CGO-free SQLite (glebarez/sqlite) 实现跨平台单二进制
- ConfigGenerator 从 DB 实体派生 sing-box JSON（非直接编辑配置文件）
- V2Ray API gRPC 流量采集，每 60 秒增量聚合
- 订阅链接公开端点（无认证），短 token 16 字符
- 弹框表单模式，所有配置操作不跳转页面

**Issues Resolved:**

- 证书更新后配置不联动 — Phase 9 修复 Generate → Apply → Restart 链
- 配置路径使用环境变量默认值 — Phase 10 修复为从 panel config 读取
- 仪表盘硬编码统计数据 — Phase 10 接入真实 API 数据

**Issues Deferred:**

- react-bits 微交互库未使用（shadcn/Tailwind 过渡效果已足够）
- UUID 搜索未实现（搜索仅过滤 name/remark）
- SUB-05 信息页仅管理面板内 Modal，无公开信息页

**Technical Debt Incurred:**

- Tag 默认值静态（vless-in-1/hy2-in-1），"下一个可用" tag 待实现
- QR 码为订阅链接级别，非逐节点 QR

---

_For current project status, see .planning/ROADMAP.md_
