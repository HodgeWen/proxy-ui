---
phase: 02-inbound-management
plan: 04
type: execute
wave: 4
depends_on: ["02-03"]
files_modified:
  - web/src/pages/Inbounds.tsx
  - web/src/components/inbounds/InboundTable.tsx
  - web/src/routes.tsx
  - web/src/components/layout/Sidebar.tsx
  - web/package.json
autonomous: true
user_setup: []

must_haves:
  truths:
    - "User can see inbound list in table layout"
    - "Edit button inline, Delete in dropdown menu"
    - "Sidebar 入站 link navigates to /inbounds"
  artifacts:
    - path: web/src/pages/Inbounds.tsx
      provides: Inbound list page
      contains: "InboundTable|useQuery"
    - path: web/src/components/inbounds/InboundTable.tsx
      provides: Table with columns, Edit, DropdownMenu
  key_links:
    - from: web/src/pages/Inbounds.tsx
      to: /api/inbounds
      via: fetch or useQuery
      pattern: "api/inbounds|useQuery"
---

<objective>
Create Inbound list page with table layout, Edit and Delete actions. Enable sidebar nav to /inbounds.

Purpose: Per CONTEXT — table layout, Edit inline, Delete in dropdown.
Output: Inbounds.tsx, InboundTable.tsx, route, sidebar enabled
</objective>

<execution_context>
@/home/whj/.claude/get-shit-done/workflows/execute-plan.md
@/home/whj/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-inbound-management/02-RESEARCH.md
@.planning/phases/02-inbound-management/02-CONTEXT.md
@web/src/pages/Dashboard.tsx
@web/src/components/layout/Sidebar.tsx
@web/src/components/layout/AppLayout.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Inbounds page, route, and shadcn components</name>
  <files>web/package.json, web/src/routes.tsx, web/src/pages/Inbounds.tsx</files>
  <action>
Install shadcn table and dropdown-menu:
  cd web && bunx shadcn@latest add table dropdown-menu

Add route in routes.tsx: under AppLayout children, add { path: "inbounds", element: <Inbounds /> }.

Create web/src/pages/Inbounds.tsx:
- useQuery with queryKey ["inbounds"], fetchFn calling GET /api/inbounds (credentials: "include")
- Typed response: { data: Inbound[] } where Inbound has id, tag, protocol, listen, listen_port, tls_type, transport_type, user_count, created_at
- Page layout: h1 "入站管理", Button "添加入站" (placeholder onClick for now), loading/error states
- Render InboundTable with data when loaded

Create web/src/components/inbounds/InboundTable.tsx as placeholder that accepts inbounds prop and renders Table with TableHeader, TableBody. Columns: 标签, 协议, 端口, TLS, 传输, 监听地址, 用户数, 创建时间, 操作. Use shadcn Table components.
</action>
  <verify>cd web && bun run build; navigate to /inbounds shows page</verify>
  <done>Inbounds page loads, fetches from API, shows table with columns</done>
</task>

<task type="auto">
  <name>Task 2: Table actions and sidebar</name>
  <files>web/src/components/inbounds/InboundTable.tsx, web/src/components/layout/Sidebar.tsx</files>
  <action>
Update InboundTable:
- Add Edit button (inline, per CONTEXT) — pass onEdit(id) callback, Button with Pencil icon
- Add DropdownMenu for each row: trigger=MoreVertical/MoreHorizontal, items: 删除 (calls onDelete(id))
- Pass onEdit and onDelete from Inbounds page (can be no-op for now; Plan 05 will wire to form modal)

Update Sidebar: change navItems entry for 入站 from disabled: true to disabled: false (or remove disabled).

Use lucide-react icons: Pencil, MoreHorizontal, Trash2.
</action>
  <verify>cd web && bun run build</verify>
  <done>Edit button and Delete dropdown visible per row; sidebar 入站 is active/enabled</done>
</task>

</tasks>

<verification>
- cd web && bun run build succeeds
- Visit /inbounds: table shows inbounds (or empty), Edit and dropdown per row
- Sidebar 入站 navigates to /inbounds
</verification>

<success_criteria>
- Table layout with required columns
- Edit inline, Delete in dropdown per CONTEXT
- Sidebar 入站 enabled
</success_criteria>

<output>
After completion, create `.planning/phases/02-inbound-management/02-04-SUMMARY.md`
</output>
