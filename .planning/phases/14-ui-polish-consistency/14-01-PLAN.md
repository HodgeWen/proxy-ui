---
phase: 14-ui-polish-consistency
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - web/src/pages/Login.tsx
  - web/src/pages/Setup.tsx
  - web/src/pages/Traffic.tsx
  - web/src/pages/Subscriptions.tsx
  - web/src/components/users/UserSubscriptionCard.tsx
autonomous: true
requirements: [UICON-01]
must_haves:
  truths:
    - "登录页与首次设置页在 light/dark 下都使用统一 token，不再出现脱节的硬编码深色面板。"
    - "订阅相关 QR 容器在暗色模式不再出现突兀白底，边框/背景与主站风格一致。"
    - "流量页统计区间距与全站主页面密度保持一致，不再出现局部过紧。"
  artifacts:
    - path: web/src/pages/Login.tsx
      provides: "认证页 token 化背景/文本/边框/输入样式"
    - path: web/src/pages/Setup.tsx
      provides: "初始化页 token 化背景/文本/边框/输入样式"
    - path: web/src/pages/Subscriptions.tsx
      provides: "订阅页 QR 弹窗容器 token 化"
    - path: web/src/components/users/UserSubscriptionCard.tsx
      provides: "用户订阅卡 QR 展示容器 token 化"
    - path: web/src/pages/Traffic.tsx
      provides: "流量统计区 gap 与全站统一"
  key_links:
    - from: web/src/pages/Login.tsx
      to: web/src/index.css
      via: "页面容器与输入控件改用 bg/text/border token utility"
      pattern: "bg-background|bg-card|text-foreground|border-input|text-muted-foreground"
    - from: web/src/pages/Setup.tsx
      to: web/src/index.css
      via: "认证页视觉从硬编码 gray/hex 迁移到主题 token"
      pattern: "bg-background|bg-card|text-foreground|border-input"
    - from: web/src/pages/Subscriptions.tsx
      to: web/src/components/users/UserSubscriptionCard.tsx
      via: "两个 QR 容器统一使用 token 背景与边框"
      pattern: "border-border|bg-card"
    - from: web/src/pages/Traffic.tsx
      to: web/src/pages/Dashboard.tsx
      via: "统计卡栅格 gap 从局部值收敛为统一节奏"
      pattern: "grid gap-6"
---

<objective>
完成 Phase 14 的 UI 一致性收敛（UICON-01）：修复认证页、订阅 QR 区和流量页间距等高风险视觉不一致点，确保全站 spacing 与色彩语义统一。

Purpose: 以最小改动关闭视觉“破口”，避免继续扩散硬编码样式并提升 dark/light 一致性。
Output: 5 个前端文件的增量修正（token 替换 + 间距收敛），且不引入新依赖。
</objective>

<execution_context>
@/home/whj/.claude/get-shit-done/workflows/execute-plan.md
@/home/whj/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md
@.planning/REQUIREMENTS.md
@.planning/phases/14-ui-polish-consistency/14-RESEARCH.md
@web/src/index.css
@web/src/pages/Login.tsx
@web/src/pages/Setup.tsx
@web/src/pages/Traffic.tsx
@web/src/pages/Subscriptions.tsx
@web/src/components/users/UserSubscriptionCard.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: 认证页去硬编码并收敛到主题 token</name>
  <files>web/src/pages/Login.tsx, web/src/pages/Setup.tsx</files>
  <action>将 Login/Setup 中 `bg-[#111827]`、`bg-[#1a1a2e]`、`text-gray-*`、`border-gray-*`、`placeholder-gray-*` 等硬编码样式替换为语义 token utility（如 `bg-background`、`bg-card`、`text-foreground`、`text-muted-foreground`、`border-input`）；保持现有交互与表单校验逻辑不变，不重构组件层次，不新增依赖。</action>
  <verify>npm --prefix web run lint</verify>
  <done>认证页在 light/dark 下视觉风格与主站一致，且不再依赖硬编码灰阶/hex 颜色。</done>
</task>

<task type="auto">
  <name>Task 2: 修复订阅二维码白底与流量页间距不一致</name>
  <files>web/src/pages/Subscriptions.tsx, web/src/components/users/UserSubscriptionCard.tsx, web/src/pages/Traffic.tsx</files>
  <action>将订阅页与用户订阅卡中的 QR 容器从 `bg-white`/非 token 边框改为 token 化样式（`bg-card` + `border-border`）；将 Traffic 顶部统计卡栅格间距从局部 `gap-4` 收敛到与全站一致的 `gap-6`；仅调整视觉 class，不改接口调用、数据结构与业务流程。</action>
  <verify>npm --prefix web run build</verify>
  <done>暗色模式下 QR 区块不再出现白块突兀感，流量页视觉密度与 Dashboard/其他页面保持一致。</done>
</task>

</tasks>

<verification>
1) `npm --prefix web run lint` 与 `npm --prefix web run build` 均通过。  
2) 手动巡检 `/login`、`/setup`：页面背景、表单容器、输入框、辅助文本均使用 token 语义色，light/dark 下无割裂。  
3) 手动巡检 `/traffic`：统计卡间距与全站主页面一致。  
4) 手动巡检 `/subscriptions` 与用户订阅详情：QR 容器在 dark 下无白底突兀块。
</verification>

<success_criteria>
- 满足 UICON-01：全局高风险页面（认证/订阅/流量）间距与色彩收敛到统一 token 体系。  
- 不新增 npm/Go 依赖。  
- 不触碰 core 状态契约、不改 5s 轮询边界与更新 SSE 逻辑。
</success_criteria>

<output>
After completion, create `.planning/phases/14-ui-polish-consistency/14-01-SUMMARY.md`
</output>
