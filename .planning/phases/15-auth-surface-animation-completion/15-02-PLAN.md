---
phase: 15-auth-surface-animation-completion
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - web/src/pages/Setup.tsx
autonomous: true
requirements: [UIANM-02, UIANM-04]
must_haves:
  truths:
    - "首次设置页主卡片具备与主站一致的首屏入场动效，且不发生布局偏移。"
    - "首次设置页提交控件与输入控件继承共享组件 hover/focus 过渡，不再使用页面私有过渡规则。"
    - "首次设置页在 reduced-motion 环境下禁用入场动画，但表单校验与提交行为保持完整。"
  artifacts:
    - path: "web/src/pages/Setup.tsx"
      provides: "Setup 页 shared primitives + entrance wrapper 实现"
      contains: "animate-in fade-in zoom-in-95 duration-300 fill-mode-both motion-reduce:animate-none"
  key_links:
    - from: "web/src/pages/Setup.tsx"
      to: "web/src/components/ui/button.tsx"
      via: "完成设置操作改为共享 Button，沿用全局 hover 时序"
      pattern: "import .*Button.* from \"@/components/ui/button\""
    - from: "web/src/pages/Setup.tsx"
      to: "web/src/components/ui/card.tsx"
      via: "设置容器改为共享 Card 以继承统一 hover 边框反馈"
      pattern: "import .*Card.* from \"@/components/ui/card\""
---

<objective>
完成 Setup 页面与 Phase 11 动效/交互基线的收敛，确保首次设置流程视觉语言与全站一致。

Purpose: 关闭 UIANM-02 与 UIANM-04 在 auth surface 的第二个缺口，避免首次设置页成为风格孤岛。
Output: `web/src/pages/Setup.tsx` 完成 shared primitives + entrance animation 对齐。
</objective>

<execution_context>
@/home/whj/.claude/get-shit-done/workflows/execute-plan.md
@/home/whj/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/15-auth-surface-animation-completion/15-RESEARCH.md
@web/src/pages/Setup.tsx
@web/src/components/ui/button.tsx
@web/src/components/ui/card.tsx
@web/src/components/ui/input.tsx
@web/src/components/ui/checkbox.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: 首次设置页切换到共享组件体系</name>
  <files>web/src/pages/Setup.tsx</files>
  <action>将 Setup 页 raw `button/input` 与卡片容器替换为共享 primitives（`Button`/`Input`/`Card`，必要时配合 `Label`）；保持现有校验规则（用户名长度、密码长度、确认密码一致）与 `/api/setup` 请求/错误处理不变；不更改字段命名、提交时机与导航行为。</action>
  <verify>npm --prefix web run build && npm --prefix web exec eslint src/pages/Setup.tsx</verify>
  <done>Setup 页主操作与表单控件由共享组件提供，hover/focus 反馈与全站一致且无功能回归。</done>
</task>

<task type="auto">
  <name>Task 2: 为首次设置卡片接入入场动效并保持可访问性</name>
  <files>web/src/pages/Setup.tsx</files>
  <action>在 Setup 页稳定外层容器上应用 `animate-in fade-in zoom-in-95 duration-300 fill-mode-both motion-reduce:animate-none`；只做首屏入场，不对错误提示和本地表单状态做动画；禁止引入新依赖与自定义 runtime 动画逻辑。</action>
  <verify>npm --prefix web run build，并手动验证 `/setup` 首屏入场无 layout shift；模拟 `prefers-reduced-motion: reduce` 时动画停用。</verify>
  <done>Setup 卡片在默认环境有平滑入场，在 reduced-motion 环境无入场动画，表单功能完整。</done>
</task>

</tasks>

<verification>
1. `npm --prefix web run build` 通过。  
2. 打开 `/setup`：卡片使用统一 fade+zoom 入场动效且不抖动。  
3. 提交按钮 hover、输入框 focus 环表现与主应用共享组件一致。  
4. reduced-motion 场景下动效禁用，校验提示与提交流程正常。
</verification>

<success_criteria>
- Setup 页面满足 UIANM-02：卡片入场动效完成并与 Phase 11 基线一致。  
- Setup 页面满足 UIANM-04：控件交互统一继承共享组件 hover/focus 系统。  
- 不新增依赖，不修改 `/api/setup` 合同与业务行为。
</success_criteria>

<output>
After completion, create `.planning/phases/15-auth-surface-animation-completion/15-02-SUMMARY.md`
</output>
